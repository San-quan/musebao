# =============================================
# Clash é…ç½®æ–‡ä»¶ï¼ˆæœ€ç»ˆç‰ˆæœ¬ä¼˜åŒ–ï¼‰
# æ—¥æœŸï¼š2025-11-14
# æè¿°ï¼šæ”¯æŒåŠ¨æ€åˆ†ç»„ã€å¤šæœºåœºã€å¥åº·æ£€æŸ¥è‡ªåŠ¨åŒ–ï¼Œä¼˜åŒ–æµé‡ç®¡ç†ä¸é€æ˜ä»£ç†
# =============================================

# ========= åŸºç¡€é…ç½® =========
mixed-port: 7890
socks-port: 7891
allow-lan: true
mode: rule                 # æŒ‰è§„åˆ™æ¨¡å¼åˆ†æµ
log-level: info
external-controller: 0.0.0.0:9090
secret: "secure-password"  # é¢æ¿è®¿é—®å¯†ç 

# ========= DNS é…ç½® =========
dns:
  enable: true
  enhanced-mode: fake-ip   # é˜² DNS æ±¡æŸ“ï¼Œæ‹¦æˆªè§£æ
  fake-ip-range: 198.18.0.1/16
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://dns.cloudflare.com/dns-query
    - tls://8.8.8.8
    - tls://1.1.1.1
  fallback:
    - https://dns.google/dns-query    # åŠ¨æ€ Fallback DNSï¼Œå‡å°‘æ±¡æŸ“é£é™©
  fallback-filter:
    geoip: true
    geoip-code: CN

# ========= èŠ‚ç‚¹é…ç½® =========
proxies:
  - name: "ğŸ‡¨ğŸ‡³ ä¸­å›½èŠ‚ç‚¹"
    type: vmess
    server: your-china-server.example.com
    port: 443
    uuid: your-uuid
    alterId: 0
    cipher: auto
    tls: true
    network: ws
    ws-opts:
      path: /ws
      headers:
        Host: host.your-china-server.com

  - name: "ğŸŒ æµ·å¤–èŠ‚ç‚¹"
    type: ss
    server: your-oversea-server.example.com
    port: 8388
    cipher: aes-128-gcm
    password: your-oversea-password
    plugin: v2ray-plugin
    plugin-opts:
      mode: websocket
      tls: true

  - name: "ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹ï¼ˆå…œåº•ï¼‰"
    type: trojan
    server: your-hk-server.example.com
    port: 443
    password: your-hk-password
    sni: host.your-hk-server.com
    udp: true

# ========= åŠ¨æ€ä»£ç†åˆ†ç»„ =========
proxy-groups:
  - name: "ğŸ¬ æµåª’ä½“åˆ†ç»„"
    type: url-test
    proxies:
      - ğŸŒ æµ·å¤–èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹ï¼ˆå…œåº•ï¼‰
    interval: 300
    tolerance: 100
    lazy: true                            # å»¶è¿Ÿæµ‹è¯•ä»…åœ¨è¢«è®¿é—®æ—¶è§¦å‘

  - name: "ğŸ“± å›½å†…åˆ†ç»„"
    type: fallback
    proxies:
      - ğŸ‡¨ğŸ‡³ ä¸­å›½èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹ï¼ˆå…œåº•ï¼‰
    health-check:
      enable: true
      url: https://www.google.com/generate_204
      interval: 600

  - name: "åŠ¨æ€å»¶è¿Ÿæµ‹é€Ÿç»„"
    type: url-test
    proxies:
      - ğŸŒ æµ·å¤–èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ ä¸­å›½èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹ï¼ˆå…œåº•ï¼‰
    interval: 300
    tolerance: 50

  - name: "å…¨å±€ä¼˜é€‰åˆ†ç»„"
    type: fallback                      # ä¼˜å…ˆå¥åº·åˆ†ç»„ï¼Œé«˜æ•ˆå…œåº•
    proxies:
      - åŠ¨æ€å»¶è¿Ÿæµ‹é€Ÿç»„
      - ğŸ“± å›½å†…åˆ†ç»„

# ========= æµé‡è§„åˆ™åˆ†é… =========
rules-providers:
  reject:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/reject.txt
    path: ./rules/reject.yaml
    interval: 86400

  china:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt
    path: ./rules/china.yaml
    interval: 86400

  media:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/streaming.txt
    path: ./rules/media.yaml
    interval: 86400

  game:
    type: http
    behavior: domain
    url: https://example.com/rules/game.yaml
    path: ./rules/game.yaml
    interval: 86400

rules:
  - RULE-SET,reject,REJECT
  - RULE-SET,china,ğŸ“± å›½å†…åˆ†ç»„
  - RULE-SET,media,ğŸ¬ æµåª’ä½“åˆ†ç»„
  - RULE-SET,game,DIRECT
  - DOMAIN-SUFFIX,example.com,DIRECT           # é’ˆå¯¹ç‰¹å®šæµé‡è§„åˆ™
  - GEOIP,CN,ğŸ“± å›½å†…åˆ†ç»„
  - MATCH,å…¨å±€ä¼˜é€‰åˆ†ç»„

# ========= è®¾å¤‡æµé‡ç®¡ç† =========
rules:
  - SRC-IP-CIDR,192.168.1.100/32,ğŸ¬ æµåª’ä½“åˆ†ç»„  # ç”µè§†æœº
  - SRC-IP-CIDR,192.168.1.101/32,åŠ¨æ€å»¶è¿Ÿæµ‹é€Ÿç»„ # æ¸¸æˆæœº
  - SRC-IP-CIDR,192.168.1.102/32,ğŸ“± å›½å†…åˆ†ç»„    # æ‰‹æœº

# ========= TUN æ¨¡å¼ =========
tun:
  enable: true
  stack: system
  strict-route: true
  dns-hijack:
    - any:53
  mtu: 1480

# ========= æµé‡å—…æ¢ =========
sniffer:
  enable: true
  force-domain:
    - +.youtube.com
    - +.spotify.com
    - +.twitch.tv

# ========= ç”¨æˆ·åå¥½å­˜å‚¨ =========
profile:
  store-selected: true
  restore-selected: true
  store-fake-ip: true
